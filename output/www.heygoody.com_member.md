 ลงทะเบียนหรือเข้าสู่ระบบ heygoody เพื่อดูรายละเอียดกรมธรรม์ function OptanonWrapper() { }  (function (w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-WRLZTM2');  (function (h, o, t, j, a, r) { h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) }; h.\_hjSettings = { hjid: 3132820, hjsv: 6 }; a = o.getElementsByTagName('head')[0]; r = o.createElement('script'); r.async = 1; r.src = t + h.\_hjSettings.hjid + j + h.\_hjSettings.hjsv; a.appendChild(r); })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv='); !function (e, r) { if (void 0 !== e && !e.adbrix) { var t = { queue: [] }, o = navigator.userAgent.toLowerCase(), n = r.createElement("script"), i = "Netscape" === navigator.appName && -1 !== navigator.userAgent.search("Trident") || -1 !== o.indexOf("msie") ? "abx-web-sdk.ie.min.js" : "abx-web-sdk.min.js"; n.type = "text/javascript", n.async = !0, n.src = "//static.adbrix.io/web-sdk/latest/" + i, n.onload = function () { e.adbrix.runQueuedFunctions ? e.adbrix.runQueuedFunctions() : console.log("[adbrix] Error: could not load SDK") }; var a = r.getElementsByTagName("script")[0]; a.parentNode.insertBefore(n, a);["init", "onInitialized", "login", "getUserId", "logout", "userProperty.get", "userProperty.getAll", "userProperty.addOrUpdate", "userProperty.remove", "userProperty.removes", "common.signUp", "common.invite", "common.useCredit", "common.purchase", "event.send", "debug.traceListener", "commerceAttr.categories", "commerceAttr.product"].forEach(function (e) { var r = e.split("."), o = r.pop(); r.reduce(function (e, r) { return e[r] = e[r] || {} }, t)[o] = function () { t.queue.push([e, arguments]) } }), e.adbrix = t } }(window, document);  window.adbrix.init({ appkey: 'F4VJSEYm80WoKISGHbL2Dg', webSecretkey: 'CXMQnacOnE6rXb9gJLVXZA', transport: 'BEACON', // push push: { enable: true, serviceWorkerOptions: { file\_name: "service-worker.js", file\_path: "/", scope: "/", }, }, inWebMessage: { enable: true, openInNewWindow: true, zIndex: 9999, fetchListener: function (message) { console.log('fetch\_listener ' + message); }, clickListener: function (actionId, actionType, actionArg, isClosed) { console.log('click\_listener ' + actionId + actionType + actionArg + isClosed); }, }, });  \<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WRLZTM2" height="0" width="0" style="display:none;visibility:hidden"\>\</iframe\>  /\* function getUrlOg() { var url = window.location.href; var origin = window.location.origin; $('[property="og:url"]').attr('content', url); $('[property="og:site\_name"]').attr('content', origin); $('[property="og:image"]').attr('content', origin + '/heygoody/media/source/og/og.jpg'); } getUrlOg();\*/  var csrfToken = "CfDJ8ItHNZMsGS1OlLfkrzpGZoFolXypxMAuGW2zmuXPPz27XdNQQhS-SU6zb9oNQV9f7fLhDyLrb7OAaSHP4SO52b\_IZjh9g3e8xpNyUWOGMC9-s-9qCsAcfyN4IDzvv8\_-R8SH0-E6t6lJDHlPt6q0sR4";

[![](/Content/images/icon-other-grey-back.svg) ]()

[<img src="/Content/images/logo/dot-com/color-black.svg" class="fn-top-logo" alt="logo" width="150" height="32"> ](/)

 html, body, .d-content-page { height: 100% !important; } .d-content-page { display: flex; flex-direction: column; } #onetrust-banner-sdk.otFlat { max-height: 100% !important; }

เข้าสู่ระบบ  
เพื่อดูรายละเอียดกรมธรรม์
==========

เฉพาะลูกค้าที่ซื้อประกันแล้ว โดยกรอกหมายเลข  
บัตรประชาชนหรือ Passport No.ของผู้เอาประกัน

![](/Content/images/icon-24-grey-close-circle.svg)

กรอกเลขบัตรประชาชน / Passport No.ให้ถูกต้อง

เข้าสู่ระบบ

![](/Content/Images/ntlInstallment/illustrate-heygoody-face-fail.svg)

ไม่สามารถเข้าสู่ระบบได้ในขณะนี้ กรุณาลองใหม่อีกครั้ง

ลองใหม่อีกครั้ง

คุณเป็นสมาชิกกับเราแล้ว  เลือกช่องทางรับรหัส OTP  
 เพื่อเชื่อมข้อมูลผู้ซื้อประกัน

เบอร์โทรศัพท์ 081-858-4455

อีเมล [[email protected]](/cdn-cgi/l/email-protection)

เลือกช่องทางรับรหัส OTP

ขอรหัส OTP

กรอกรหัส OTP

 รหัส OTP ถูกส่งไปยัง (รหัสอ้างอิง: XYZ123)  
\*\*\*-\*\*\*-4455 แล้ว

![](/Content/Images/icon-24-grey-close-circle.svg)

กรอกรหัส OTP

รหัส OTP หมดอายุแล้ว

รหัส OTP ไม่ถูกต้อง ลองอีกครั้ง

ไม่สามารถเข้าสู่ระบบได้ในขณะนี้ ติดต่อ Line heygoody เพื่อให้เราช่วยเหลือ 24 ชั่วโมง

ยืนยัน

หากยังไม่ได้รับรหัส OTP  
ลองดูที่กล่องจดหมายขยะ หรือสแปม

รหัส OTP มีอายุการใช้งาน 5 นาที

คุณสามารถขอรหัสใหม่ได้ใน 59 วินาที

[![](/Content/Images/icon/icon-24-green-reset.svg)ขอรหัส OTP ใหม่](javascript:void(0))

คุณยังไม่มีบัญชีของ heygoody

ช้อปเลย เรามีประกัน <img src="/Content/travel/images/elements/car.webp" alt="car" width="25" height="25"> <img src="/Content/travel/images/elements/plane.webp" alt="plane" width="25" height="25"> <img src="/Content/travel/images/elements/growing-heart.webp" alt="growing" width="25" height="25"> <img src="/Content/travel/images/elements/accident.webp" alt="accident" width="25" height="25"> ให้เลือกหลากหลาย ซื้อเองได้ 24 ชั่วโมง #ผ่อนสด0%ก็ได้ผ่านบัตรก็ดี

ปิด เช็คเบี้ย

![](/Content/Images/ntlInstallment/illustrate-heygoody-face-fail.svg)

เกิดข้อผิดพลาดระหว่างการจัดการข้อมูลส่วนบุคคคล

รับทราบ

 มีปัญหา ทักหาเราได้ตลอด 24 ชม.  
 Line **@heygoody**

 var actionlogin = "1"; var action = ""; var acc\_status = ""; var loginstep = 1; $(document).load(function () { $(".grecaptcha-badge").addClass("d-none"); }); window.addEventListener('load', function () { $("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLogin").removeClass("d-none"); }); $(document).ready(function () { $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function () { $(".modal-backdrop").addClass('modal-backdrop-loading'); }); /\*(".fn-otp-input").focus(function(){ if($(this).next().val() == "" || $(this).next().val() == undefined) { $(this).nextAll().prop("disabled", true); } else { $(this).nextAll().removeAttr('disabled'); } });\*/ //$("#test").click(function () { //$.ajax({ //	type: "POST", //HTTP POST Method //	url: "/Login/testemail", // Controller/action //	beforeSend: function(xhr) { // xhr.setRequestHeader('X-CSRF-Token', csrfToken) //	}, //	//async: false, //	//data: { //	// NationID: $("#IDCard").val().replace(/-/g,""), //	// Firstname : $("#nameIDCard").val(), //	// Lastname : $("#surnameIDCard").val(), //	// Phonenumber : $("#phoneNumber").val().replace(/-/g,""), //	// Email : $("#email").val() //	//}, //	success: function (result) { // console.log(result); // //window.location.href = "/login"; //	} //}); //}); let checkDataFrom = $("#hdfdatafrom").val(); if (checkDataFrom == "PopupRegisterInformation") { //กดสมัครจาก popup ให้ข้ามหน้าแรกของการสมัคร acc\_status = "success"; GTM\_info\_createaccount(); $("#divlogin").addClass("d-none"); $("#condition").removeClass("d-none"); //$("#fn-policy-footer").removeClass("d-none"); } //check ForgetPasswordPopup let ForgetPasswordPopup = ''; if (ForgetPasswordPopup == "1") { $("#divlogin").addClass("d-none"); $("#divforgotpass").removeClass("d-none"); setTimeout(function () { $("#fn-phonenum-email-forgotpass").focus(); }, 1000); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/ForgetPasswordPopup", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, //data: { //	NationID: $("#IDCard").val().replace(/-/g,""), //	Firstname : $("#nameIDCard").val(), //	Lastname : $("#surnameIDCard").val(), //	Phonenumber : $("#phoneNumber").val().replace(/-/g,""), //	Email : $("#email").val() //}, success: function (result) { //console.log(result); //window.location.href = "/login"; } }); } //let redirectTo = ''; //console.log("aa=\> "+redirectTo); if ($("#IDCardmain").val() != "") { $("#fn-createaccount").addClass("active"); $("#fn-createaccount-page").addClass("active"); $("#fn-createaccount-page").addClass("show"); $("#fn-login").removeClass("active"); $("#fn-login-page").removeClass("active"); $("#fn-login-page").removeClass("show"); //let IDCardMaskIndex = IMask( //	document.getElementById('IDCardmain'), //	{ // mask: '0-0000-00000-00-0' //	}); //let phoneNumberMaskIndex = IMask( //	document.getElementById('phoneNumber'), //	{ // mask: '#!0-000-0000', // definitions: { // // \<any single char\>: \<same type as mask (RegExp, Function, etc.)\> // // defaults are '0', 'a', '\*' // '#': /[0]/, // '!': /[6-9]/ // } //	}); } $("#fn-btn-create").click(function () { grecaptcha.ready(function () { grecaptcha.execute('', { action: 'submit' }).then(function (token) { actionlogin = "1"; //console.log("aaaaa"); let txtIDCard = document.getElementById("IDCardmain"); let txtname = document.getElementById("nameIDCard"); let txtsurname = document.getElementById("surnameIDCard"); let txtphoneNumber = document.getElementById("phoneNumber"); let txtemail = document.getElementById("email"); let sesIDCard = $("#hdfIDCard").val(); let sesname = $("#hdfnameIDCard").val(); let sessurname = $("#hdfsurnameIDCard").val(); let sesphoneNumber = $("#hdfphoneNumber").val(); let sesemail = $("#hdfemail").val(); let datafrom = $("#hdfdatafrom").val(); //card if (txtIDCard.value == "") { txtIDCard.parentElement.classList.add("errorempty"); } else if (txtIDCard.value != "") { let checkDigit = check\_digit\_id\_card(txtIDCard.value.replace(/-/g, "")); if (!checkDigit) { txtIDCard.parentElement.classList.add("errorvalid"); } else { txtIDCard.parentElement.classList.remove("errorvalid"); } } else if ((sesIDCard != "") && (sesIDCard != txtIDCard.value.replace(/-/g, "")) && (datafrom == "OrdersInformation")) { txtIDCard.parentElement.classList.add("errorvalid"); } else { txtIDCard.parentElement.classList.remove("errorvalid"); } //name if (txtname.value == "") { txtname.parentElement.classList.add("errorempty"); } else if ((sesname != "") && (sesname != txtname.value) && (datafrom == "OrdersInformation")) { txtname.parentElement.classList.add("errorvalid"); } else { txtname.parentElement.classList.remove("errorvalid"); } //lastname if (txtsurname.value == "") { txtsurname.parentElement.classList.add("errorempty"); } else if ((sessurname != "") && (sessurname != txtsurname.value) && (datafrom == "OrdersInformation")) { txtsurname.parentElement.classList.add("errorvalid"); } else { txtsurname.parentElement.classList.remove("errorvalid"); } //phone if (txtphoneNumber.value == "") { txtphoneNumber.parentElement.classList.add("errorempty"); } else if ((sesphoneNumber != "") && (sesphoneNumber != txtphoneNumber.value.replace(/-/g, "")) && (datafrom == "OrdersInformation")) { txtphoneNumber.parentElement.classList.add("errorvalid"); } else if ((txtphoneNumber.value != "") && (txtphoneNumber.value.length != 12)) { txtphoneNumber.parentElement.classList.add("errorvalid"); } else { txtphoneNumber.parentElement.classList.remove("errorvalid"); } //email if (txtemail.value == "") { txtemail.parentElement.classList.add("errorempty"); $(".fn-valid-email").removeClass("d-none"); } else if (txtemail.value != "") { let checkEmail = isEmail(txtemail.value); if (!checkEmail) { txtemail.parentElement.classList.add("errorempty"); $(".fn-valid-email").removeClass("d-none"); } ////email must englist alphabet only //let pattern\_thai = /^[เธ-เน\\s]+$/u; //let findAlphabetEmail = email.match(pattern\_thai); ////End email must englist alphabet only } if ((sesemail != "") && (sesemail != txtemail.value) && (datafrom == "OrdersInformation")) { txtemail.parentElement.classList.add("errorvalid"); } var txtLogin = document.getElementById("fn-phonenum-email"); txtLogin.parentElement.classList.remove("errorempty"); var get1error = document.querySelectorAll(".errorempty")[0]; var get2error = document.querySelectorAll(".errorvalid")[0]; if ((get1error != undefined) && (get2error != undefined)) { acc\_status = "empty, not match"; GTM\_info\_createaccount(); } else if (get1error != undefined) { acc\_status = "empty"; GTM\_info\_createaccount(); } else if (get2error != undefined) { acc\_status = "not match"; GTM\_info\_createaccount(); } if (get1error != undefined) { setTimeout(function () { get1error.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 200); } else if (get2error != undefined) { setTimeout(function () { get2error.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 200); } else { //window.location.href = "../1.5/info\_createaccountselectchannel.html"; //$("#fn-info-error3").modal('show'); gotoSignup(); //$.ajax({ //	type: "POST", //HTTP POST Method //	url: "/Signup/Signup", // Controller/action //	//async: false, //	data: { // IdentityNumber: $("#IDCard").val().replace(/-/g,""), // //Firstname : $("#nameIDCard").val(), // //Lastname : $("#surnameIDCard").val(), // Phonenumber : $("#phoneNumber").val().replace(/-/g,""), // Email : $("#email").val() //	}, //	success: function (result) { // console.log(result); // if(result == "1"){ // //found IdentityNumber // $("#fn-info-error2").modal('show'); // } // else if(result == "2"){ // //found PhoneNumber or Email // $("#fn-info-error1").modal('show'); // } // else if(result == "success"){ // $("#divlogin").addClass("d-none"); // $("#divOTP").removeClass("d-none"); // $("#showNumberSelectOTP").text("เบอร์โทรศัพท์ " + $("#phoneNumber").val()); // $("#showEmailSelectOTP").text("อีเมล " + $("#email").val()); // } // //if(result == "success"){ // //	alert(result); // //} //	} //}); } }); }); }); function enterLogin() { // old /\* if ($("#fn-phonenum-email").val() == "") { $("#fn-phonenum-email").parent().addClass("errorempty"); }else{ $("#fn-phonenum-email").parent().removeClass("errorempty"); } if ($("#fn-txt-pass").val() == "") { $("#fn-txt-pass").parent().addClass("errorempty"); $(".fn-valid").removeClass('d-none'); }else{ $("#fn-txt-pass").parent().removeClass("errorempty"); $(".fn-valid").addClass('d-none'); } if($("#fn-phonenum-email").val() != "" && $("#fn-txt-pass").val() != ""){ //let a = "/member"; //console.log("sdssd =\> "+a); grecaptcha.ready(function() { grecaptcha.execute('6Lfi0cIpAAAAAIoo-8eUfy2g1-AdNXxrSkDhVx-T', {action: 'submit'}).then(function(token) { console.log("fn-btn-loginh"); $("#loginfail").addClass("d-none"); let get1error\_login = document.querySelectorAll(".errorempty")[0]; if(get1error\_login != undefined){ setTimeout(function () { get1error\_login.scrollIntoView({behavior: 'smooth', block: 'center'}); }, 200); }else{ //$("#fn-loading").modal("show"); $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function(){ $(".modal-backdrop").addClass('modal-backdrop-loading'); }) //$.ajaxSetup({ // headers: { 'X-CSRF-TOKEN': csrfToken } //}); console.log("csrfToken =\> "+csrfToken); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Login", // Controller/action beforeSend: function(xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { Username: $("#fn-phonenum-email").val(), Password : $("#fn-txt-pass").val(), RedicrectToURL: "", token : token }, success: function (result) { //console.log(result); //let Identity = result; console.log("Login =\> "+(result != "") ); if(result != ""){ if(result != "Inactive"){ //window.location.href = urlresult; let resultSplit = result.split("|"); let Identity = resultSplit[0]; let GTM\_userid = resultSplit[1]; let GTM\_method = resultSplit[2]; dataLayer.push({ event: "login", user\_id: GTM\_userid, method: GTM\_method }); $.ajax({ type: "POST", //HTTP POST Method url: "/PDPA/StatusInquiry", // Controller/action //async: false, //beforeSend: function(xhr) { //xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { account\_id\_card :Identity }, success: function (result) { //console.log(result); console.log("StatusInquiry"); if(result.statusdesc != null){ console.log("result != null"); if(result.transaction\_status){ window.location.href = "/pdpa"; }else{ $.ajax({ type: "POST", //HTTP POST Method url: "/Login/checkFlowBuyInsurance", // Controller/action //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, //headers: { // RequestVerificationToken: csrfToken //}, success: function (result) { console.log("aa=\> "+result); if(result != "fail"){ //$("#fn-loading").modal('hide'); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-info-error4").modal('show'); $("#lblorderid").val(result); } else{ //ข้ามไม่ต้องทำ PDPA กลับไปหน้าเดิม let redirectTo = ''; if(redirectTo != ""){ //window.location.href = "/" + redirectTo; window.location.href = redirectTo.toLowerCase(); }else{ window.location.href = "/"; } } }, error: function (result) { console.log("error checkFlowBuyInsurance =\>"+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } } else{ dataLayer.push({ event: "error\_case", user\_id: GTM\_userid, error\_id: result.response\_code, error\_type: "system error", error\_category: result.response\_code, error\_label: result.response\_message }); console.log("result = null"); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-pdpa").modal('show'); if($("#fn-login-footer").hasClass('d-none')==true){ $("#fn-login-footer").removeClass('d-none'); } } }, error: function (result) { console.log("error StatusInquiry =\>"+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } else{ console.log("Login fail Inactive"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#login-err-fraud").removeClass("d-none"); } } else { console.log("Login fail"); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#loginfail").removeClass("d-none"); } }, error : function (result) { console.log("error Login =\> "+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } }); }); }else{ console.log("Login Failed"); } \*/ // end old //new if ($("#fn-phonenum-email").val() == "") { newCheckLogin(); } //else if (($("#fn-phonenum-email").val().length \> 0) && ($("#fn-phonenum-email").val().length \< 17)) { // newCheckLogin(); //} else if ($("#fn-phonenum-email").val().length \> 0) { grecaptcha.ready(function () { grecaptcha.execute('6Lfi0cIpAAAAAIoo-8eUfy2g1-AdNXxrSkDhVx-T', { action: 'submit' }).then(function (token) { console.log("fn-btn-loginh"); $("#loginfail").addClass("d-none"); let txtIDCard = document.getElementById("fn-phonenum-email"); if (txtIDCard.value != "") { let checkDigit = check\_digit\_id\_card(txtIDCard.value.replace(/-/g, "")); if (!checkDigit) { txtIDCard.parentElement.classList.add("errorvalid"); } else { txtIDCard.parentElement.classList.remove("errorvalid"); } } //let get1error\_login = document.querySelectorAll(".errorempty")[0]; //let get2error\_login = document.querySelectorAll(".errorvalid")[0]; //if ((get1error\_login != undefined) || (get2error\_login != undefined)) { // setTimeout(function () { // get1error\_login.scrollIntoView({ behavior: 'smooth', block: 'center' }); // }, 200); //} else { //$("#fn-loading").modal("show"); $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function () { $(".modal-backdrop").addClass('modal-backdrop-loading'); }) //$.ajaxSetup({ // headers: { 'X-CSRF-TOKEN': csrfToken } //}); console.log("csrfToken =\> " + csrfToken); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Loginnew", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { Username: $("#fn-phonenum-email").val().replace(/-/g, "") }, success: function (result) { console.log(result); //let Identity = result; //console.log("Login =\> "+(result != "") ); if (result != "") { if (result != "not found" && result != "ORDER\_NOT\_FOUND") { loginstep = 2; $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLogin").addClass("d-none"); $("#divOTP").removeClass("d-none"); let resultSplit = result.split("|"); // $("#hdfphoneNumber").val(resultSplit[4]); // $("#hdfemail").val(resultSplit[3]); $("#hdfuserid").val(resultSplit[3]); $("#spRefPhone").text(resultSplit[1]); $("#spRefEmail").text(resultSplit[2]); } else if (result == "ORDER\_NOT\_FOUND") { $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-login").modal("show"); } else { console.log("not found order"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-login").modal("show"); } } else { console.log("Login fail"); $("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); //$("#loginfail").removeClass("d-none"); } }, error: function (result) { console.log("error Login =\> " + result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLoginSystemFail").removeClass("d-none"); $("#divLogin").addClass("d-none"); $("#divOTP").addClass("d-none"); pushErrorLoginSystemFail() } }); //} }); }); //console.log"fn-btn-loginh"); $("#loginfail").addClass("d-none"); let txtIDCard = document.getElementById("fn-phonenum-email"); //if (txtIDCard.value != "") { // let checkDigit = check\_digit\_id\_card(txtIDCard.value.replace(/-/g, "")); // if (!checkDigit) { // txtIDCard.parentElement.classList.add("errorvalid"); // } // else { // txtIDCard.parentElement.classList.remove("errorvalid"); // } //} let get1error\_login = document.querySelectorAll(".errorempty")[0]; let get2error\_login = document.querySelectorAll(".errorvalid")[0]; if ((get1error\_login != undefined) || (get2error\_login != undefined)) { setTimeout(function () { get1error\_login.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 200); } else { //$("#fn-loading").modal("show"); $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function () { $(".modal-backdrop").addClass('modal-backdrop-loading'); }) //$.ajaxSetup({ // headers: { 'X-CSRF-TOKEN': csrfToken } //}); //console.log"csrfToken =\> "+csrfToken); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Loginnew", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { Username: $("#fn-phonenum-email").val().replace(/-/g, "") }, success: function (result) { console.log(result); //let Identity = result; //console.log("Login =\> "+(result != "") ); if (result != "") { if (result != "not found" && result != "ORDER\_NOT\_FOUND") { loginstep = 2; //$("#fn-loading").removeClass("show"); //$("#fn-loading").css("display", "none"); $("#divLogin").addClass("d-none"); $("#divOTP").removeClass("d-none"); let resultSplit = result.split("|"); // $("#hdfphoneNumber").val(resultSplit[4]); // $("#hdfemail").val(resultSplit[3]); $("#hdfuserid").val(resultSplit[3]); $("#spRefPhone").text(resultSplit[1]); $("#spRefEmail").text(resultSplit[2]); } else if (result == "ORDER\_NOT\_FOUND") { $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-login").modal("show"); } else { //console.log"not found order"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-login").modal("show"); } } else { //console.log"Login fail"); $("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); //$("#loginfail").removeClass("d-none"); } }, error: function (result) { //console.log"error Login =\> "+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLoginSystemFail").removeClass("d-none"); $("#divLogin").addClass("d-none"); pushErrorLoginSystemFail() } }); } } else { //console.log"Login Failed"); } } //$("#fn-phonenum-email").keypress(function (event) { // var keycode = (event.keyCode ? event.keyCode : event.which); // if (keycode == '13') { // enterLogin(); // } // event.stopPropagation(); //}); $("#fn-txt-pass").keypress(function (event) { var keycode = (event.keyCode ? event.keyCode : event.which); if (keycode == '13') { enterLogin(); } event.stopPropagation(); }); $("#fn-btn-loginh").click(function () { enterLogin(); }); /\* $("#fn-btn-loginh").click(function () { });\*/ $("#fn-btn-loginAgain").click(function () { $("#divLogin").removeClass("d-none"); $("#divLoginSystemFail").addClass("d-none"); pushErrorLoginSystemFailClick() location.reload(); }); $("#forgotpasslogin").click(function () { $("#divlogin").addClass("d-none"); $("#divforgotpass").removeClass("d-none"); $("#fn-phonenum-email-forgotpass").focus(); }); var eventForgetpass = false; $("#fn-btn-forgetpass").click(function () { //$("#btnforgotpass").click(function () { //console.log"fn-btn-forgetpass"); if ($("#fn-phonenum-email-forgotpass").val() == "") { $("#passwordfail").addClass("d-none"); $("#fn-phonenum-email-forgotpass").parent().addClass('errorempty'); $("#fn-phonenum-email-forgotpass").parent().removeClass('errornotmat'); $("#fn-phonenum-email-forgotpass").parent().eq(2).find('fn-valid-feedback').css("display", "block"); } else { $("#fn-title-OTP").text('กรอกรหัส OTP เพื่อตั้งรหัสผ่านใหม่'); $("#fn-phonenum-email-forgotpass").parent().removeClass('errempty'); $("#fn-phonenum-email-forgotpass").parent().eq(2).find('fn-valid-feedback').css("display", "none"); actionlogin = "2"; //console.logactionlogin); eventForgetpass = true; //let mailphoneForgot = $("#txtforgotpass").val(); $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/ForgotPassword", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { //phoneEmail: $("#txtforgotpass").val() phoneEmail: $("#fn-phonenum-email-forgotpass").val() }, success: function (result) { //console.logresult); //console.logresult.actionname); if (result.actionname != "") { $("#divforgotpass").addClass("d-none"); $("#verifyOTP").removeClass("d-none"); $("#spRefOTP").text(result.ref\_otp); if (result.actionname == "phone") { let phoneNumber = result.phonenumber; let last4char = phoneNumber.substr(-4); let textcen = "\*\*\*-\*\*\*-"; $("#spRefPhone").text(textcen.concat(last4char)); } else { $("#spRefPhonetxt").text("ไปที่อีเมล"); $("#spRefPhone").text(result.email); } document.getElementById("OTP\_1").focus(); countdownFunc(); } else { $("#passwordfail").removeClass("d-none"); $("#fn-phonenum-email-forgotpass").parent().addClass('errornotmat'); $("#fn-phonenum-email-forgotpass").parent().eq(2).find('fn-valid-feedback').addClass("d-none"); } }, error: function (result) { //console.log"error ForgotPassword =\>"+result); } }); var container = document.getElementsByClassName("fn-otp-input-section")[0]; container.onkeyup = function (e) { var target = e.srcElement || e.target; var maxLength = parseInt(target.attributes["maxlength"].value, 10); var myLength = target.value.length; if (myLength \>= maxLength) { var next = target; while (next = next.nextElementSibling) { if (next == null) break; if (next.tagName.toLowerCase() === "input") { next.focus(); break; } } } // Move to previous field if empty (user pressed backspace) else if (myLength === 0) { var previous = target; while (previous = previous.previousElementSibling) { if (previous == null) break; if (previous.tagName.toLowerCase() === "input") { //previous.focus(); break; } } } } } }); $("#notaccept").click(function () { //$("#condition").addClass("d-none"); //$("#divlogin").removeClass("d-none"); $("#fn-info-error3").modal('show'); }); }); function gotoSignup() { $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/Signup", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { IdentityNumber: $("#IDCardmain").val().replace(/-/g, ""), Phonenumber: $("#phoneNumber").val().replace(/-/g, ""), Email: $("#email").val() }, success: function (result) { //console.logresult); if (result == "1") { //found IdentityNumber acc\_status = "ID Duplicate"; $("#fn-info-error2").modal('show'); GTM\_info\_createaccount(); } else if (result == "2") { //found PhoneNumber or Email acc\_status = "Contact Duplicate"; $("#fn-info-error1").modal('show'); GTM\_info\_createaccount(); } else if (result == "success") { acc\_status = "success"; GTM\_info\_createaccount(); $("#divlogin").addClass("d-none"); $("#condition").removeClass("d-none"); } }, error: function (result) { //console.log"error Signup =\>"+result); } }); } function gotoTermCon() { $("#divlogin").addClass("d-none"); $("#condition").removeClass("d-none"); } function gotoHomepageLogin() { $("#fn-loading").modal("show"); window.location.href = "/"; } function gotoCheckInsurance() { $("#fn-loading").modal("show"); window.location.href = "/checkinsurance"; } function gotoCheckout() { $("#fn-loading").modal("show"); let result = $("#lblorderid").val(); window.location.href = "/checkout?order=" + result; } function gotoSelect() { $("#fn-policy-footer").addClass("d-none"); $("#condition").addClass("d-none"); $("#divOTP").removeClass("d-none"); $("#showNumberSelectOTP").text("เบอร์โทรศัพท์ " + $("#phoneNumber").val()); $("#showEmailSelectOTP").text("อีเมล " + $("#email").val()); } function GTMSelectChannel() { if ($('input[name="fn-rdo-select"]:checked').val() == "1") { dataLayer.push({ event: "select\_otp\_channel", section: "login", method: "phone\_call", }); //Motor renewal // gtmRequestOTP("member\_ocr", "phone\_call"); } else { dataLayer.push({ event: "select\_otp\_channel", section: "login", method: "email", }); //Motor renewal // gtmRequestOTP("member\_ocr", "email"); } } function checkSelectOTP() { $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function () { $(".modal-backdrop").addClass('modal-backdrop-loading'); }); // new if ($('input[name="fn-rdo-select"]:checked').val() == undefined) { $("#errorSelectOTP").removeClass("d-none"); $(".fn-rdo-box label").addClass("errorempty"); } else if ($('input[name="fn-rdo-select"]:checked').val() == "1") { //OTP ผ่านเบอร์ $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Loginnew", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, data: { Username: $("#fn-phonenum-email").val().replace(/-/g, "") }, success: function (result) { console.log(result); if (result != "") { $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/OTPLogIn", // Controller/action //async: false, beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, data: { userId: $("#hdfuserid").val(), action: "7" }, success: function (result) { //console.logresult); if (result.status) { loginstep = 3; $(".fn-otp-input-section .fn-valid-feedback").addClass("d-none"); $(".fn-otp-input-section .fn-form-content").removeClass("errorValidOTP"); $("#expireOTP").addClass("d-none"); $("#showTrashEmail").addClass("d-none"); $("#hdfselectOTP").val("phone"); $("#divOTP").addClass("d-none"); $("#verifyOTP").removeClass("d-none"); $("#spRefOTP").text(result.ref\_otp); // let phoneNumber = result.phonenumber; // let last4char = phoneNumber.substr(-4); // let textcen = "\*\*\*-\*\*\*-"; $("#spRefPhoneOTP").text(result.phonenumber); $("#OTP\_1").val(""); $("#requestOTP").addClass("d-none"); $("#expireOTP").addClass("d-none"); $("#invalidOTP").addClass("d-none"); $("#timeCountDown").show(); $(".countdown").html("59"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); document.getElementById("OTP\_1").focus(); countdownFunc(); } else { window.location.href = window.location.origin + "/"; } }, error: function (result) { //console.log"error OTP =\>"+result); } }); } }, error: function (result) { console.log("error Login =\> " + result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLoginSystemFail").removeClass("d-none"); $("#divLogin").addClass("d-none"); pushErrorLoginSystemFail() $("#divOTP").addClass("d-none"); } }); } else { //OTP ผ่านเมล์ $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Loginnew", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, data: { Username: $("#fn-phonenum-email").val().replace(/-/g, "") }, success: function (result) { console.log(result); if (result != "") { $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/OTPEmailLogIn", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { userId: $("#hdfuserid").val(), action: "7" }, success: function (result) { if (result.status) { console.log(result) loginstep = 3; $(".fn-otp-input-section .fn-valid-feedback").addClass("d-none"); $(".fn-otp-input-section .fn-form-content").removeClass("errorValidOTP"); $("#expireOTP").addClass("d-none"); $("#hdfselectOTP").val("email"); $("#divOTP").addClass("d-none"); $("#verifyOTP").removeClass("d-none"); $("#spRefOTP").text(result.ref\_otp); console.log(result.email); // let emailDomain = result.email.substr(0, result.email.indexOf("@")); // let emailSubdomain = result.email.substr(result.email.indexOf("@")); // console.log(emailDomain); // console.log(emailSubdomain); // let firstChar = emailDomain.substring(0, 1); // let lastChar = emailDomain.substring(emailDomain.length - 1); // let setRefEmail = ""; // if (emailDomain.length \>= 7) { // setRefEmail = firstChar + "\*\*\*\*\*" + lastChar + emailSubdomain; // } // else { // setRefEmail = firstChar; // for (let i = 0; i \< emailDomain.length - 2; i++) { // setRefEmail += "\*"; // } // setRefEmail += lastChar + emailSubdomain; // } $("#spRefPhoneOTP").text(result.email); $("#requestOTP").addClass("d-none"); $("#expireOTP").addClass("d-none"); $("#invalidOTP").addClass("d-none"); $("#timeCountDown").show(); $(".countdown").html("59"); $("#OTP\_1").val(""); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); document.getElementById("OTP\_1").focus(); countdownFunc(); } else { window.location.href = window.location.origin + "/"; } }, error: function (result) { //console.log"error OTP =\>"+result); } }); } }, error: function (result) { console.log("error Login =\> " + result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLoginSystemFail").removeClass("d-none"); $("#divLogin").addClass("d-none"); pushErrorLoginSystemFail() } }); } // End new } var container = document.getElementsByClassName("fn-otp-input-section")[0]; container.onkeyup = function (e) { var target = e.srcElement || e.target; var maxLength = parseInt(target.attributes["maxlength"].value, 10); var myLength = target.value.length; if (myLength \>= maxLength) { var next = target; while (next = next.nextElementSibling) { if (next == null) break; if (next.tagName.toLowerCase() === "input") { next.focus(); break; } } } // Move to previous field if empty (user pressed backspace) else if (myLength === 0) { var previous = target; while (previous = previous.previousElementSibling) { if (previous == null) break; if (previous.tagName.toLowerCase() === "input") { //previous.focus(); break; } } } } // request new otp function requestNewOTP() { //new if ($('input[name="fn-rdo-select"]:checked').val() == "1") { //OTP ผ่านเบอร์ let RefPhoneEmail = ""; //GTM CR Membership dataLayer.push({ event: "request\_new\_otp", section: "login", method: "phone\_call", }); //Motor renewal // gtmRequestNewOTP("member\_ocr","phone\_call"); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Loginnew", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, data: { Username: $("#fn-phonenum-email").val().replace(/-/g, "") }, success: function (result) { console.log(result); if (result != "") { $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/OTPLogIn", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, data: { userId: $("#hdfuserid").val(), // phonenumber: $("#hdfphoneNumber").val(), action: "7" }, success: function (result) { //console.logresult); $("#spRefOTP").text(result.ref\_otp); $(".fn-otp-input-section .fn-form-content").removeClass("errorempty"); $(".fn-otp-input-section .fn-form-content").removeClass("errorValidOTP"); $(".fn-otp-input-section .fn-valid-feedback").removeClass("d-none"); $(".fn-otp-input").val(""); document.getElementById("OTP\_1").focus(); //countdownFunc(); $("#requestOTP").addClass("d-none"); $("#expireOTP").addClass("d-none"); $("#invalidOTP").addClass("d-none"); $("#timeCountDown").show(); $(".countdown").html("59"); countdownFunc(); }, error: function (result) { //console.log"error OTP =\>"+result); } }); } }, error: function (result) { console.log("error Login =\> " + result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLoginSystemFail").removeClass("d-none"); $("#divLogin").addClass("d-none"); pushErrorLoginSystemFail() } }); } else if ($('input[name="fn-rdo-select"]:checked').val() == "2") { //OTP ผ่านเมล์ //GTM CR Membership dataLayer.push({ event: "request\_new\_otp", section: "login", method: "email", }); //Motor renewal // gtmRequestNewOTP("member\_ocr","email"); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Loginnew", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, data: { Username: $("#fn-phonenum-email").val().replace(/-/g, "") }, success: function (result) { console.log(result); if (result != "") { $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/OTPEmailLogIn", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { userId: $("#hdfuserid").val(), // email: $("#hdfemail").val(), action: "7" }, success: function (result) { //console.logresult); $("#spRefOTP").text(result.ref\_otp); $(".fn-otp-input-section \> .fn-form-content").removeClass("errorempty"); $(".fn-otp-input-section .fn-form-content").removeClass("errorValidOTP"); $(".fn-otp-input-section .fn-valid-feedback").removeClass("d-none"); $(".fn-otp-input").val(""); document.getElementById("OTP\_1").focus(); //countdownFunc(); $("#showTrashEmail").removeClass("d-none"); $("#requestOTP").addClass("d-none"); $("#expireOTP").addClass("d-none"); $("#invalidOTP").addClass("d-none"); $("#timeCountDown").show(); $(".countdown").html("59"); countdownFunc(); }, error: function (result) { //console.log"error OTP =\>"+result); } }); } }, error: function (result) { console.log("error Login =\> " + result); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#divLoginSystemFail").removeClass("d-none"); $("#divLogin").addClass("d-none"); pushErrorLoginSystemFail() } }); } // end new } // verify otp function verifyOTP() { grecaptcha.ready(function () { grecaptcha.execute('6Lfi0cIpAAAAAIoo-8eUfy2g1-AdNXxrSkDhVx-T', { action: 'submit' }).then(function (token) { console.log("reCAPTCHA token:", token); // new let otp1 = $("#OTP\_1").val(); let otpValue = otp1; if (otpValue == "") { //กรุณากรอกรหัส OTP //$("#invalidOTP").removeClass("d-none"); $(".fn-otp-input-section .fn-form-content").removeClass("errorValidOTP"); $(".fn-otp-input-section .fn-valid-feedback").removeClass("d-none"); $("#expireOTP").addClass("d-none"); $("#invalidOTP").addClass("d-none"); //ยิง GTM กรุณากรอกรหัส OTP gtmRequestNewOTPwithError($(".fn-otp-input-section .fn-valid-feedback").text()); } else { $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function () { $(".modal-backdrop").addClass('modal-backdrop-loading'); }) let phonenumber = ""; let email = ""; let GTM\_method\_OTP = ""; //let action = ""; if ($("#hdfselectOTP").val() == "phone") { phonenumber = $("#hdfphoneNumber").val(); email = $("#hdfemail").val(); action = "phone";//phone GTM\_method\_OTP = "phone\_call"; //ยิงเมื่อ user กดปุ่ม ยืนยัน OTP // gtmFillOTP("member\_ocr", "phone\_call"); } else if ($("#hdfselectOTP").val() == "email") { phonenumber = $("#hdfphoneNumber").val(); email = $("#hdfemail").val(); action = "email"; GTM\_method\_OTP = "email"; //ยิงเมื่อ user กดปุ่ม ยืนยัน Email // gtmFillOTP("member\_ocr", "email"); } //ยิงเมื่อ user กดปุ่ม ยืนยัน OTP dataLayer.push({ event: "otp\_submission", section: "login", method: GTM\_method\_OTP }) $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/VerifyOTPLogIn", // Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { action: action, phonenumber: phonenumber, email: email, otp: otpValue, ref\_otp: $("#spRefOTP").text(), identitynumber: $("#fn-phonenum-email").val().replace(/-/g, ""), token: token, userid: $("#hdfuserid").val() }, success: function (result) { if (result == "not\_human") { $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#invalidCaptcha").removeClass("d-none"); } else { $("#invalidCaptcha").addClass("d-none"); if (result != "") { clearCountdown(); let resultSplit = result.split("|"); let Identity = resultSplit[0]; let GTM\_userid = resultSplit[1]; let GTM\_method = resultSplit[2]; if (GTM\_method == "phone") { GTM\_method = "phone\_call"; } dataLayer.push({ event: "login", //user\_id: GTM\_userid, method: GTM\_method }); ///Load Test //window.location.href = "/profile/myinsurance"; ///Load Test End ///\*\*\*\*ปกติ let checkDigit = check\_digit\_id\_card($("#fn-phonenum-email").val().replace(/-/g, "")); if (checkDigit) { $.ajax({ type: "POST", //HTTP POST Method url: "/PDPA/StatusInquiry", // Controller/action //async: false, //beforeSend: function(xhr) { //xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { account\_id\_card: Identity }, success: function (result) { console.log(result); //console.log("StatusInquiry"); if (result.statusdesc != null) { //$("#fn-loading").removeClass("show"); //$("#fn-loading").css("display", "none"); console.log("result != null"); window.location.href = "/profile"; //window.location.href = "/pdpa"; //if(result.transaction\_status){ //	window.location.href = "/pdpa"; //}else{ //	// Check screen width //	if ($(window).width() \<= 992) { // window.location.href = "/profile"; //	} else { // window.location.href = "/profile/myinsurance"; //	} //} } else { dataLayer.push({ event: "error\_case", user\_id: GTM\_userid, error\_id: result.response\_code, error\_type: "system error", error\_category: result.response\_code, error\_label: result.response\_message }); console.log("result = null"); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-pdpa").modal('show'); if ($("#fn-login-footer").hasClass('d-none') == true) { $("#fn-login-footer").removeClass('d-none'); } } }, error: function (result) { console.log("error StatusInquiry =\>" + result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } else { window.location.href = "/profile" } ///\*\*\*ปกติ end } else if (cd5min \<= 0) { $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#expireOTP").removeClass("d-none"); gtmRequestNewOTPwithError($("#lblexpireOTP").text()); $(".fn-otp-input-section .fn-valid-feedback").addClass("d-none"); $(".fn-otp-input-section .fn-form-content").addClass("errorValidOTP"); $("#invalidOTP").addClass("d-none"); } else { //รหัส OTP ไม่ถูก $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#invalidOTP").removeClass("d-none"); $("#expireOTP").addClass("d-none"); $(".fn-otp-input-section .fn-form-content").addClass("errorValidOTP"); $(".fn-otp-input-section .fn-valid-feedback").addClass("d-none"); //ยิง GTM รหัส OTP ไม่ถูก pushGTMError(); $(".fn-otp-input").click(function () { if ($(".fn-otp-input").val() != "") { $(".fn-otp-input").val(""); $("#OTP\_1").focus(); $("#invalidOTP").addClass("d-none"); $("#expireOTP").addClass("d-none"); $(".fn-otp-input-section .fn-valid-feedback").removeClass("d-none"); $(".fn-otp-input-section \> .fn-form-content").removeClass("errorempty"); } }); } } }, error: function (result) { //console.log"error VerifyOTP =\>"+result); } }); } // End new }); }); } function setPassword() { let checkPass = $("#fn-txt-pass-regis").val(); let checkConPass = $("#fn-txt-conpass").val(); //password must have character and Number let findChar = checkPass.match(/[A-Za-z]/g); let findCharNum = checkPass.match(/\\d+/); //End password must have character and Number if ((checkPass == "") || (checkPass.length \< 8) || (findChar == null) || (findCharNum == null)) { $("#fn-txt-pass-regis").closest('div').addClass('errorempty'); $(".fn-text-confirmpassword").css('color', 'var(--syst-1-error)'); $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-notmatch").addClass("d-none"); } else { $("#fn-txt-pass-regis").closest('div').removeClass('errorempty'); $(".fn-text-confirmpassword").css('color', 'var(--1-txt-3-caption)'); } if (checkConPass == "") { $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-empty").removeClass("d-none"); $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-notmatch").addClass("d-none"); $("#fn-txt-conpass").parent().addClass("errorempty"); } else if ((checkPass.length \< 8) && (checkConPass != "")) { $("#fn-txt-conpass").parent().addClass("errorempty"); $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-empty").addClass("d-none"); $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-notmatch").addClass("d-none"); } else { $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-empty").addClass("d-none"); $("#fn-txt-conpass").parent().removeClass("errorempty"); } if ((checkPass != "") && (checkConPass != "") && (checkPass.length \>= 8) && (findChar != null) && (findCharNum != null)) { if (checkPass == checkConPass) { //console.logactionlogin); //open loading $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function () { $(".modal-backdrop").addClass('modal-backdrop-loading'); }) //End open loading if (actionlogin == "1") { //create account $("#fn-title-OTP").text('กรอกรหัส OTP เพื่อสมัครใช้งาน'); $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/Setpassword", //Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { Username: $("#email").val(), Password: $("#fn-txt-conpass").val(), IdentityNumber: $("#IDCardmain").val().replace(/-/g, ""), Firstname: $("#nameIDCard").val(), Lastname: $("#surnameIDCard").val(), Phonenumber: $("#phoneNumber").val().replace(/-/g, ""), action: action, refotp: $("#spRefOTP").text() }, success: function (result) { //console.logresult); //close loading $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); //End close loading if (result.includes("success")) { $("#fn-dialog-sucsess").modal('show'); $(".fn-valid-password").addClass('d-none'); $("#fn-txt-conpass").closest('div').removeClass('errorempty'); let resultSplit = result.split("|"); let userid = resultSplit[1]; let method = ""; if ($("#spRefPhonetxt").text().includes("เบอร์")) { method = "Phone"; } else if ($("#spRefPhonetxt").text().includes("อีเมล")) { method = "Email"; } $.ajax({ type: "POST", //HTTP POST Method url: "/PDPA/StatusInquiry", //Controller/action //async: false, data: { account\_id\_card: $("#IDCardmain").val().replace(/-/g, "") }, success: function (result) { //console.logresult); if (result.statusdesc != null) { if (result.transaction\_status) { window.location.href = "/pdpa"; } else { //ข้ามไม่ต้องทำ PDPA กลับไปหน้าเดิม let redirectTo = ''; if (redirectTo != "") { //window.location.href = "/" + redirectTo; window.location.href = redirectTo.toLowerCase(); } else { window.location.href = "/"; } } } else { dataLayer.push({ event: "error\_case", user\_id: userid, error\_id: result.response\_code, error\_type: "system error", error\_category: result.response\_code, error\_label: result.response\_message }); //console.log"vvvvvv"); $("#fn-dialog-error-pdpa").modal('show'); if ($("#fn-login-footer").hasClass('d-none') == true) { $("#fn-login-footer").removeClass('d-none'); } } }, error: function (result) { //console.log"error StatusInquiry =\>"+result); } }); var count = 2.5, timer = setInterval(function () { $(".countdown").html(count--); if (count \<= -1) { $("#fn-dialog-sucsess").modal('hide'); } }, 1000); //e.stopPropagation(); } }, error: function (result) { //console.log"error Setpassword =\>"+result); } }); } else { //forgot password $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/SetForgotPassword", //Controller/action beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { //PhoneEmail : $("#txtforgotpass").val(), PhoneEmail: $("#fn-phonenum-email-forgotpass").val(), Password: $("#fn-txt-conpass").val() }, success: function (result) { //console.logresult); //close loading $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); //End close loading if (result == "success") { $("#fn-dialog-forgotpass-sucsess").modal('show'); $(".fn-valid-password").addClass('d-none'); $("#fn-txt-conpass").closest('div').removeClass('errorempty'); var count = 2.5, timer = setInterval(function () { $(".countdown").html(count--); if (count \<= -1) { $("#fn-dialog-forgotpass-sucsess").modal('hide'); $("#divlogin").removeClass("d-none"); $("#setPassword").addClass("d-none"); } }, 1000); //e.stopPropagation(); } }, error: function (result) { //console.log"error SetForgotPassword =\>"+result); } }); } } else { $("#fn-txt-conpass").parents().eq(2).find(".fn-conpass-notmatch").removeClass("d-none"); $("#fn-txt-conpass").closest('div').addClass('errorempty'); } } } function GTM\_info\_createaccount() { dataLayer.push({ event: "info\_createaccount", account\_status: acc\_status, // \*\*\*Required / eg. empty, not match, ID duplicate, Contact Duplicate, success }); } function check\_digit\_id\_card(id\_card) { var multi\_num = 13; var str\_digit = 0; var result = 0; if (id\_card.length != 13) { return false; } while (multi\_num != 1) { if (id\_card.charAt(str\_digit) == Number.NaN) { return false; } result = result + id\_card.charAt(str\_digit) \* multi\_num; multi\_num = multi\_num - 1; str\_digit = str\_digit + 1; } result = result % 11; if (result == 0) result = 10; result = 11 - result; if (result == 10) result = 0; if (result == id\_card.charAt(12)) { return true; } else { return false; } } function submitCreate(e) { e.preventDefault(); grecaptcha.ready(function () { grecaptcha.execute('6Lfi0cIpAAAAAIoo-8eUfy2g1-AdNXxrSkDhVx-T', { action: 'submit' }).then(function (token) { // Add your logic to submit to your backend server here. }); }); } function submitLogin(e) { e.preventDefault(); grecaptcha.ready(function () { grecaptcha.execute('6Lfi0cIpAAAAAIoo-8eUfy2g1-AdNXxrSkDhVx-T', { action: 'submit' }).then(function (token) { // Add your logic to submit to your backend server here. }); }); } //GobackLogin function gobackLogin() { if (loginstep == 1) { //alert("a"); window.location.href = window.location.origin + "/"; } else if (loginstep == 2) { //alert("b"); loginstep = 1; $("#divLogin").removeClass("d-none"); $("#divOTP").addClass("d-none"); } else if (loginstep == 3) { //alert("c"); loginstep = 2; $("#divOTP").removeClass("d-none"); $("#verifyOTP").addClass("d-none"); } dataLayer.push({ event: 'click\_back', }); } function newCheckLogin() { let checkValueIDCard = $("#fn-phonenum-email").val().length; if (checkValueIDCard == 0) { $("#fn-phonenum-email").parent().addClass('errorempty'); } //else if (checkValueIDCard \> 0 && checkValueIDCard \< 17) { // $("#fn-phonenum-email").parent().addClass('errorvalid'); //} else { $("#fn-phonenum-email").parent().removeClass('errorempty'); $("#fn-phonenum-email").parent().removeClass('errorvalid'); } } $("#fn-phonenum-email").on('blur', function () { newCheckLogin(); }); // imask identification card var IDCardMaskLogin = IMask( document.getElementById('fn-phonenum-email'), { mask: /^[A-Za-z0-9\\s]+$/ } ); // auto generate clear button text when focus input Array.prototype.forEach.call(document.querySelectorAll(".fn-form-text"), function (el) { var input = el.querySelector("input"); //conditionallyHideClearIcon(); input.addEventListener("input", conditionallyHideClearIcon); //Click x Icon var checkSpan = el.querySelector('[data-clear-input]'); // alert(checkSpan); if (checkSpan !== null) { checkSpan.addEventListener('click', function (e) { input.value = ''; conditionallyHideClearIcon(); IDCardMaskLogin.updateValue(); $(this).parent().removeClass('errorvalid'); }); } //Input type text On change el.querySelector('input').addEventListener('blur', function (e) { var inputval = e.target.value; setTimeout(function () { e.target.nextElementSibling.style.display = 'none'; }, 150); if (inputval == "") { e.target.parentElement.classList.add("errorempty"); if ($("#OTP\_1").val() == "" && $("#expireOTP").hasClass("d-none")) { $("#OTP\_1").closest(".fn-form-content").find(".fn-valid-feedback").removeClass("d-none"); } } else { e.target.parentElement.classList.remove("errorempty"); } }); el.querySelector('input').addEventListener('focus', function (e) { var inputval = e.target.value; if (inputval == "") { //e.target.parentElement.classList.add("errorempty"); setTimeout(function () { e.target.nextElementSibling.style.display = 'none'; }, 150); } else { e.target.parentElement.classList.remove("errorempty"); setTimeout(function () { e.target.nextElementSibling.style.display = 'block'; }, 150); } }); //Input type text On keyup var otpInput = el.querySelector('.fn-otp-input'); if (otpInput) { otpInput.addEventListener('keyup', function (e) { var inputval = e.target.value; setTimeout(function () { e.target.nextElementSibling.style.display = 'none'; }, 150); if (inputval == "") { e.target.parentElement.classList.add("errorempty"); } else { e.target.parentElement.classList.remove("errorempty"); } }); } function conditionallyHideClearIcon(e) { var target = (e && e.target) || input; target.nextElementSibling.style.display = target.value ? 'block' : 'none'; target.value ? '' : target.parentElement.classList.remove("errorempty"); } }); //Push GTM Error Case const myModalErrorLogin = document.getElementById('fn-dialog-error-login') if (myModalErrorLogin) { myModalErrorLogin.addEventListener('shown.bs.modal', event =\> { //let gtmCategory = document.title; let errorLabel = document.querySelector("#fn-dialog-error-login .gtm-errorLabel"); let gtmErrorLabel = errorLabel.textContent.replace(/\\n/g, '').trim(); dataLayer.push({ event: "error\_case", error\_category: "login", error\_action: "error", error\_label: gtmErrorLabel, }); }) } const myModalErrorPdpa = document.getElementById('fn-dialog-error-pdpa') if (myModalErrorPdpa) { myModalErrorPdpa.addEventListener('shown.bs.modal', event =\> { //let gtmCategory = document.title; let errorLabel = document.querySelector("#fn-dialog-error-pdpa .gtm-errorLabel"); let gtmErrorLabel = errorLabel.textContent.replace(/\\n/g, '').trim(); dataLayer.push({ event: "error\_case", error\_category: "login", error\_action: "error", error\_label: gtmErrorLabel, }); }) } const errorActionElements = document.querySelectorAll(".gtm-errorAction"); errorActionElements.forEach(errorActionElement =\> { errorActionElement.addEventListener("click", () =\> { //let gtmCategory = document.title; let errorLabel = errorActionElement.closest(".modal").querySelector(".gtm-errorLabel"); let gtmErrorLabel = errorLabel.textContent.replace(/\\n/g, '').trim(); const gtmErrorAction = errorActionElement.textContent.replace(/\\n/g, '').trim(); dataLayer.push({ event: "error\_case", error\_category: "login", error\_action: gtmErrorAction, error\_label: gtmErrorLabel, }); }); }); function pushErrorLoginSystemFail() { let errorLabel = document.querySelector("#divLoginSystemFail .gtm-errorLabel"); let gtmErrorLabel = errorLabel.textContent.replace(/\\n/g, '').trim(); dataLayer.push({ event: "error\_case", error\_category: "login", error\_action: "error", error\_label: gtmErrorLabel, }); } function pushErrorLoginSystemFailClick() { let button = document.getElementById("fn-btn-loginAgain"); let buttonText = button.textContent.replace(/\\n/g, '').trim(); let errorLabel = document.querySelector("#divLoginSystemFail .gtm-errorLabel"); let gtmErrorLabel = errorLabel.textContent.replace(/\\n/g, '').trim(); dataLayer.push({ event: "error\_case", error\_category: "login", error\_action: buttonText, error\_label: gtmErrorLabel, }); } // หน้า OTP - เชื่อมบัญชี ยิงเมื่อ user กดปุ่ม ขอรหัส OTP function gtmRequestOTP(flow, method){ dataLayer.push({ event: "select\_otp\_channel", section: flow, //member\_ocr, member\_fill-info method: method //phone\_call, email }); } // หน้า OTP - กรอกรหัส ยิงเมื่อ user กดปุ่ม ยืนยัน function gtmFillOTP(flow, method){ dataLayer.push({ event: "otp\_submission", section: flow, //new\_ocr, member\_ocr, new\_fill-info, member\_fill-info, change\_telno method: method //phone\_call, email }); } //หน้า OTP ยิงเมื่อ user กดปุ่ม ขอรหัส OTP ใหม่ function gtmRequestNewOTP(flow, method){ dataLayer.push({ event: "request\_new\_otp", section: flow, //new\_ocr, member\_ocr, new\_fill-info, member\_fill-info, change\_telno method: method //phone\_call, email }); } function gtmRequestNewOTPwithError(error\_label) { dataLayer.push({ event: "error\_case", error\_category: "motor\_renew\_otp", // eg. travel\_otp error\_action: "error", error\_label: error\_label, // \*\*\*Required / eg. รหัส OTP หมดอายุแล้ว, รหัส OTP ไม่ถูกต้อง ลองอีกครั้ง, กรอกรหัส OTP }); } function pushGTMError(){ gtmRequestNewOTPwithError($("#lblinvalidOTP").text()); }

สวัสดี! คุณ ![](/Content/Images/illustrate-emoji-hello.svg)

[ จัดการบัญชีของฉัน ](/profile)

![](/Content/Images/element-smile-logo.svg)

 .grecaptcha-badge { z-index: 1080; }

![](/Content/Images/logo-horizontal-heygoody-on-white.svg)

[เข้าสู่ระบบ](#) [สมัครใช้งาน](#)

 โอ๊ะ! เราพบความผิดปกติในบัญชีของคุณ เพื่อความปลอดภัย สามารถติดต่อเจ้าหน้าที่ให้ช่วยตรวจสอบได้ที่ [**02 792 1987**](tel:027921987)

 ลองตรวจสอบความถูกต้องของ เบอร์โทรศัพท์ อีเมล  
 หรือรหัสผ่าน อีกครั้ง

![](/Content/Images/icon-24-grey-close-circle.svg) เบอร์โทรศัพท์หรืออีเมล

กรอกเบอร์โทรศัพท์หรืออีเมล

![](/Content/Images/icon-24-grey-password-invisible.svg) ![](/Content/Images/icon-24-grey-password-visible.svg) รหัสผ่าน

กรอกรหัสผ่าน

เข้าสู่ระบบ

[ลืมรหัสผ่าน? คลิกที่นี่]()

![](/Content/Images/icon-24-grey-close-circle.svg) เลขที่บัตรประชาชน

กรอกเลขบัตรประชาชนผู้เอาประกันให้ถูกต้อง

![](/Content/Images/icon-24-grey-close-circle.svg) ชื่อตามบัตรประชาชน

กรอกชื่อตามบัตรประชาชนให้ถูกต้อง

![](/Content/Images/icon-24-grey-close-circle.svg) นามสกุลตามบัตรประชาชน

กรอกนามสกุลตามบัตรประชาชนให้ถูกต้อง

![](/Content/Images/icon-24-grey-close-circle.svg) เบอร์โทรศัพท์ผู้เอาประกัน

กรอกเบอร์โทรศัพท์ผู้เอาประกันให้ถูกต้อง

![](/Content/Images/icon-24-grey-close-circle.svg)

กรอกอีเมลผู้เอาประกันให้ถูกต้อง

สมัคร

[นโยบายความเป็นส่วนตัว](/privacypolicy) | [นโยบายส่วนบุคคลเกี่ยวกับคุกกี้](/cookiepolicy)

รอสักครู่

 มีบัญชีที่ใช้เบอร์โทรศัพท์  
หรือ อีเมลนี้แล้ว

 ตรวจสอบข้อมูลอีกครั้ง หรือติดต่อเราได้ที่  
02-792-1987

ปิด [ติดต่อเรา](tel:027921987)

 มีบัญชีที่ใช้เลขบัตรประชาชนนี้แล้ว

 เข้าสู่ระบบเพื่อดำเนินการต่อ

ปิด เข้าสู่ระบบ

![](/Content/Images/illustrate-popup-alert.svg)

 คุณต้องการออกจากขั้นตอน  
การซื้อประกันใช่หรือไม่?

ยกเลิก ตกลง

 คุณต้องการออกจาก  
 การทำรายการใช่หรือไม่?

 หากออกจากหน้านี้คุณจะต้อง  
 เริ่มทำรายการใหม่

อยู่ต่อ ออก

![](/Content/Images/ntlInstallment/illustrate-heygoody-face-fail.svg)

เกิดข้อผิดพลาดระหว่างการจัดการข้อมูลส่วนบุคคล

รับทราบ

 var acc\_status\_pop = ""; var SendObject = {}; $(document).ready(function() { //clear value $("#IDCardpop").val(""); $("#nameIDCardpop").val(""); $("#surnameIDCardpop").val(""); $("#phoneNumberpop").val(""); $("#emailpop").val(""); $("#fn-btn-createpop").click(function () { grecaptcha.ready(function() { grecaptcha.execute('6Ld1n7giAAAAAMz6awLymHLH88VLsx0zNx2MHB88', { action: 'submit' }).then(function (token) { let txtIDCard = document.getElementById("IDCardpop"); let txtname = document.getElementById("nameIDCardpop"); let txtsurname = document.getElementById("surnameIDCardpop"); let txtphoneNumber = document.getElementById("phoneNumberpop"); let txtemail = document.getElementById("emailpop"); //card if(txtIDCard.value == ""){ txtIDCard.parentElement.classList.add("errorempty"); //return false; } else if(txtIDCard.value != ""){ let checkDigit = check\_digit\_id\_card(txtIDCard.value.replace(/-/g,"")); if(!checkDigit){ txtIDCard.parentElement.classList.add("errorvalid"); } } //if((sesIDCard != "") && (sesIDCard != txtIDCard.value.replace(/-/g,""))){ //	txtIDCard.parentElement.classList.add("errorvalid"); //} //name if(txtname.value == ""){ txtname.parentElement.classList.add("errorempty"); //return false; } //else if((sesname != "") && (sesname != txtname.value)){ //	txtname.parentElement.classList.add("errorvalid"); //}else{ //	txtname.parentElement.classList.remove("errorvalid"); //} //lastname if(txtsurname.value == ""){ txtsurname.parentElement.classList.add("errorempty"); //return false; } //else if((sessurname != "") && (sessurname != txtsurname.value)){ //	txtsurname.parentElement.classList.add("errorvalid"); //}else{ //	txtsurname.parentElement.classList.remove("errorvalid"); //} //phone if(txtphoneNumber.value == ""){ txtphoneNumber.parentElement.classList.add("errorempty"); //return false; } //else if((sesphoneNumber != "") && (sesphoneNumber != txtphoneNumber.value.replace(/-/g,""))){ //	txtphoneNumber.parentElement.classList.add("errorvalid"); //}else{ //	txtphoneNumber.parentElement.classList.remove("errorvalid"); //} //email if(txtemail.value == ""){ txtemail.parentElement.classList.add("errorempty"); $(".fn-valid-email").removeClass("d-none"); //return false; } else if(txtemail.value != ""){ let checkEmail = isEmail(txtemail.value); if(!checkEmail){ txtemail.parentElement.classList.add("errorempty"); $(".fn-valid-email").removeClass("d-none"); } ////email must englist alphabet only //let pattern\_thai = /^[เธ-เน\\s]+$/u; //let findAlphabetEmail = email.match(pattern\_thai); ////End email must englist alphabet only } let txtLoginpop = document.getElementById("fn-phonenum-emailpop"); txtLoginpop.parentElement.classList.remove("errorempty"); let get1errorpop = document.querySelectorAll(".errorempty")[0]; let get2errorpop = document.querySelectorAll(".errorvalid")[0]; if(get1errorpop != undefined){ setTimeout(function () { get1errorpop.scrollIntoView({behavior: 'smooth', block: 'center'}); }, 200); }else if(get2errorpop != undefined){ setTimeout(function () { get2errorpop.scrollIntoView({behavior: 'smooth', block: 'center'}); }, 200); }else{ gotoSignupPOP(); //$.ajax({ //	type: "POST", //HTTP POST Method //	url: "/Login/RegisterPopup", // Controller/action // beforeSend: function(xhr) { // xhr.setRequestHeader('X-CSRF-Token', csrfToken) // }, //	//async: false, //	data: { // NationID: $("#IDCardpop").val().replace(/-/g,""), // Firstname : $("#nameIDCardpop").val(), // Lastname : $("#surnameIDCardpop").val(), // Phonenumber : $("#phoneNumberpop").val().replace(/-/g,""), // Email : $("#emailpop").val() //	}, //	success: function (result) { // //console.log(result); // window.location.href = "/login"; //	}, //	error: function (result) { // console.log("error RegisterPopup =\> "+result); //	} //}); } }); }); }); function enterPopupLogin() { if ($("#fn-phonenum-emailpop").val() == "") { $("#fn-phonenum-emailpop").parent().addClass("errorempty"); }else{ $("#fn-phonenum-emailpop").parent().removeClass("errorempty"); } if ($("#fn-txt-passpop").val() == "") { $("#fn-txt-passpop").parent().addClass("errorempty"); $(".fn-valid").removeClass('d-none'); }else{ $("#fn-txt-passpop").parent().removeClass("errorempty"); $(".fn-valid").addClass('d-none'); } if($("#fn-phonenum-emailpop").val() != "" && $("#fn-txt-passpop").val() != ""){ //let a = "/member"; //console.log("sdssd =\> "+a); grecaptcha.ready(function() { grecaptcha.execute('6Ld1n7giAAAAAMz6awLymHLH88VLsx0zNx2MHB88', {action: 'submit'}).then(function(token) { console.log("fn-btn-loginh"); $("#loginfail").addClass("d-none"); let get1error\_login = document.querySelectorAll(".fn-login-pag .errorempty")[0]; if(get1error\_login != undefined){ setTimeout(function () { get1error\_login.scrollIntoView({behavior: 'smooth', block: 'center'}); }, 200); }else{ //$("#fn-loading").modal("show"); $("#fn-loading").addClass("show"); $("#fn-loading").css("display", "block"); $("#fn-loading").on('shown.bs.modal', function(){ $(".modal-backdrop").addClass('modal-backdrop-loading'); }) //$.ajaxSetup({ // headers: { 'X-CSRF-TOKEN': csrfToken } //}); console.log("csrfToken =\> "+csrfToken); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/Login", // Controller/action beforeSend: function(xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { Username: $("#fn-phonenum-emailpop").val(), Password : $("#fn-txt-passpop").val(), RedicrectToURL: "", token : token }, success: function (result) { //console.log(result); //let Identity = result; console.log("Login =\> "+(result != "") ); if(result != ""){ if(result != "Inactive"){ //window.location.href = urlresult; let resultSplit = result.split("|"); let Identity = resultSplit[0]; let GTM\_userid = resultSplit[1]; let GTM\_method = resultSplit[2]; dataLayer.push({ event: "login", //user\_id: GTM\_userid, //comment GTM LOGIN lot4 method: GTM\_method }); $.ajax({ type: "POST", //HTTP POST Method url: "/PDPA/StatusInquiry", // Controller/action //async: false, //beforeSend: function(xhr) { //xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, //headers: { // "\_\_RequestVerificationToken" : csrfToken //}, data: { account\_id\_card :Identity }, success: function (result) { //console.log(result); console.log("StatusInquiry"); if (result.statusdesc != null) { if(result.transaction\_status){ window.location.href = "/pdpa"; }else{ $.ajax({ type: "POST", //HTTP POST Method url: "/Login/checkFlowBuyInsurance", // Controller/action //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, //headers: { // RequestVerificationToken: csrfToken //}, success: function (result) { console.log("aa=\> "+result); if(result != "fail"){ //$("#fn-loading").modal('hide'); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-popup-login").modal('hide'); $("#fn-info-error4").modal('show'); gtmLoadModalError4(); $("#lblorderid").val(result); }else{ //ข้ามไม่ต้องทำ PDPA กลับไปหน้าเดิม let redirectTo = ''; console.log("redirectTo =\> "+redirectTo); if(redirectTo != ""){ //window.location.href = "/" + redirectTo; window.location.href = redirectTo; }else{ //window.location.href = "/"; let forname = getFormName(); setSessionData(forname); } } }, error: function (result) { console.log("error checkFlowBuyInsurance =\>"+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } } else{ dataLayer.push({ event: "error\_case", user\_id: GTM\_userid, //error\_id: result.response\_code, error\_id: "none", error\_type: "system error", error\_category: result.response\_code, error\_label: result.response\_message }); console.log("result = null"); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#fn-dialog-error-pdpapop").modal('show'); if($("#fn-login-footer").hasClass('d-none')==true){ $("#fn-login-footer").removeClass('d-none'); } } }, error: function (result) { console.log("error StatusInquiry =\>"+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } else{ console.log("Login fail Inactive"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#login-err-fraud").removeClass("d-none"); } } else { console.log("Login fail"); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); $("#loginfail").removeClass("d-none"); } }, error : function (result) { console.log("error Login =\> "+result); //$("#fn-loading").modal("hide"); $("#fn-loading").removeClass("show"); $("#fn-loading").css("display", "none"); } }); } }); }); } } $("#fn-phonenum-emailpop").keypress(function(event){ var keycode = (event.keyCode ? event.keyCode : event.which); if(keycode == '13'){ enterPopupLogin(); } event.stopPropagation(); }); $("#fn-txt-passpop").keypress(function(event){ var keycode = (event.keyCode ? event.keyCode : event.which); if(keycode == '13'){ enterPopupLogin(); } event.stopPropagation(); }); $("#fn-btn-login").click(function () { enterPopupLogin(); }); $("#fn-forgetpass").click(function () { $.ajax({ type: "POST", //HTTP POST Method url: "/Login/ForgetPasswordPopup", // Controller/action beforeSend: function(xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, //data: { //	NationID: $("#IDCard").val().replace(/-/g,""), //	Firstname : $("#nameIDCard").val(), //	Lastname : $("#surnameIDCard").val(), //	Phonenumber : $("#phoneNumber").val().replace(/-/g,""), //	Email : $("#email").val() //}, success: function (result) { //console.log(result); window.location.href = "/login"; }, error: function (result) { console.log("error ForgetPasswordPopup =\> "+result); //window.location.href = "/login"; } }); }); }); function gotoCheckout(){ gtmCancelModalError4(); let result = $("#lblorderid").val(); window.location.href = "/checkout?order=" + result; } function gotoHomepage(){ gtmCancelModalError4(); $("#fn-loading").modal("show"); window.location.href = "/"; } function gtmStay() { $.ajax({ type: "POST", url: "/RenewCheckInsurance/get\_gtm\_product\_category", data: { //type:type, req: SendObject }, //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, success: function (data) { dataLayer.push({ event: "renew\_plan", event\_category: "renew\_plan", event\_action: "click", event\_label: "อยู่ต่อ", product\_category: data }); } }); } function gotoProfile(){ $.ajax({ type: "POST", url: "/RenewCheckInsurance/get\_gtm\_product\_category", data: { //type:type, req: SendObject }, //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, success: function (data) { dataLayer.push({ event: "renew\_plan", event\_category: "renew\_plan", event\_action: "click", event\_label: "ออก", product\_category: data }); } }); $("#fn-loading").modal("show"); window.location.href = "/profile"; } // reCAPTCHA v3 function reCaptcha() { var reCAPTCHA = document.createElement("script"); reCAPTCHA.src = "https://www.google.com/recaptcha/api.js?render=6Ld1n7giAAAAAMz6awLymHLH88VLsx0zNx2MHB88"; reCAPTCHA.id = "recaptchaV3"; $("body").append(reCAPTCHA); } $('#fn-popup-login').on('shown.bs.modal', function(e) { reCaptcha(); e.stopPropagation(); }) $('#fn-popup-login').on('hide.bs.modal', function(e) { $('#recaptchaV3').remove(); $('.grecaptcha-badge').parent().remove(); }) function check\_digit\_id\_card(id\_card) { var multi\_num = 13; var str\_digit = 0; var result = 0; if(id\_card.length != 13) { return false; } while(multi\_num != 1) { if(id\_card.charAt(str\_digit) == Number.NaN) { return false; } result = result + id\_card.charAt(str\_digit)\*multi\_num; multi\_num = multi\_num - 1; str\_digit = str\_digit + 1; } result = result % 11; if(result == 0) result = 10; result = 11 - result; if(result == 10) result = 0; if(result == id\_card.charAt(12)) { return true; } else { return false; } } function submitCreate(e) { e.preventDefault(); grecaptcha.ready(function() { grecaptcha.execute('6Ld1n7giAAAAAMz6awLymHLH88VLsx0zNx2MHB88', {action: 'submit'}).then(function(token) { // Add your logic to submit to your backend server here. }); }); } function submitLogin(e) { e.preventDefault(); grecaptcha.ready(function() { grecaptcha.execute('6Ld1n7giAAAAAMz6awLymHLH88VLsx0zNx2MHB88', {action: 'submit'}).then(function(token) { // Add your logic to submit to your backend server here. }); }); } function setSessionData(name) { if(name == "CHECKINSURANCE"){ var brandname = $('.brandselect option:selected').text(); var brandid = $('.brandselect option:selected').val(); var model = $('.modelselect option:selected').val(); var submodel = $("input[name='fn-carinfo-details']:checked").next('label:first').find('span').text(); var submodelid = $("input[name='fn-carinfo-details']:checked").val(); var year = $('#ddlyear option:selected').val(); var insucode = $('#ddlinsu').val(); var startyear = $("input[name='fn-carinfo-expiryyear']:checked").val(); var objective = $('input[name="carobject"]:checked').val(); var decorate = $('input[name="cardetail"]:checked').val(); var ip; $.getJSON("https://api.ipify.org/?format=json", function (e) { ip = e.ip; }); $.ajax({ type: "POST", url: "/login/setSessionDataCheckInsurance", //async: false, //beforeSend: function (xhr) { // xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, data: { brand: brandname, brandid: brandid, model: model, modelid: model, submodel: submodel, submodelid: submodelid, year: year, insucode: insucode, startyear: startyear, objective: objective, decorate: decorate, IPaddress: ip }, success: function (data) { console.log(data); location.reload(); } }); } else if(name == "ORDERSINFO"){ var AddressObj = { Address:$('#txtaddress').val(), Zipcode:$('#txtzipcode').val(), Province:$('#ddlAddProv :selected').text(), SubDistrict:$('#ddlAddSubDist :selected').text(), District: $('#ddlAddDist :selected').text(), ProvinceID:$('#ddlAddProv').val(), SubDistrictID:$('#ddlAddSubDist').val(), DistrictID: $('#ddlAddDist').val(), }; var AddressDeliObj; if($('#addrIDCard').is(":checked")) { AddressDeliObj = { Address:$('#txtaddress').val(), Zipcode:$('#txtzipcode').val(), Province:$('#ddlAddProv :selected').text(), SubDistrict:$('#ddlAddSubDist :selected').text(), District: $('#ddlAddDist :selected').text(), ProvinceID:$('#ddlAddProv').val(), SubDistrictID:$('#ddlAddSubDist').val(), DistrictID: $('#ddlAddDist').val(), type: "1" }; } else { AddressDeliObj = { Address:$('#txtaddress1').val(), Zipcode:$('#txtzipcode1').val(), Province:$('#ddlAddProv1 :selected').text(), SubDistrict:$('#ddlAddSubDist1 :selected').text(), District: $('#ddlAddDist1 :selected').text(), ProvinceID:$('#ddlAddProv1').val(), SubDistrictID:$('#ddlAddSubDist1').val(), DistrictID: $('#ddlAddDist1').val(), type: "2" }; } var InformationObj = { TitleName:$('#ddlTitle :selected').text(), FirstName:$('#nameIDCard').val(), LastName :$('#surnameIDCard').val(), NationID : $('#IDCard').val().replaceAll("-",""), BirthDate : $('#hdfbdate').val(), PhoneNumber : $('#phoneNumber').val().replaceAll("-",""), Email: $('#email').val() }; var CarObj = { CarID : $('#txt\_carID').val(), CarIden :$('#tankID').val(), CarProvince : $('#regis-province :selected').text(), StartDate :$('#hdfsdate').val(), CarProvinceID : $('#regis-province').val() }; var SendObject = { reqAddress: AddressObj, reqInfo: InformationObj, reqCar : CarObj, reqDeliveryAdr: AddressDeliObj } $.ajax({ type: "POST", url: "/login/setSessionDataOrdersInfo", data: { //type:type, req:SendObject }, //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, success: function (data) { console.log(data); location.reload(); } }); } else{ location.reload(); } } function gotoSignupPOP(){ $.ajax({ type: "POST", //HTTP POST Method url: "/Signup/Signup", // Controller/action beforeSend: function(xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { IdentityNumber: $("#IDCardpop").val().replace(/-/g,""), //Firstname : $("#nameIDCard").val(), //Lastname : $("#surnameIDCard").val(), Phonenumber : $("#phoneNumberpop").val().replace(/-/g,""), Email : $("#emailpop").val() }, success: function (result) { console.log(result); if(result == "1"){ //found IdentityNumber acc\_status\_pop = "ID Duplicate"; $("#fn-info-error2").modal('show'); GTM\_info\_createaccountpop(); } else if(result == "2"){ //found PhoneNumber or Email acc\_status\_pop = "Contact Duplicate"; $("#fn-info-error1").modal('show'); GTM\_info\_createaccountpop(); } else if(result == "success"){ //acc\_status = "success"; //GTM\_info\_createaccountpop(); //$("#divlogin").addClass("d-none"); //$("#condition").removeClass("d-none"); //$("#fn-info-error3").modal('show'); //$("#divOTP").removeClass("d-none"); //$("#showNumberSelectOTP").text("เบอร์โทรศัพท์ " + $("#phoneNumber").val()); //$("#showEmailSelectOTP").text("อีเมล " + $("#email").val()); $.ajax({ type: "POST", //HTTP POST Method url: "/Login/RegisterPopup", // Controller/action beforeSend: function(xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, //async: false, data: { NationID: $("#IDCardpop").val().replace(/-/g,""), Firstname : $("#nameIDCardpop").val(), Lastname : $("#surnameIDCardpop").val(), Phonenumber : $("#phoneNumberpop").val().replace(/-/g,""), Email : $("#emailpop").val() }, success: function (result) { //console.log(result); window.location.href = "/login"; }, error: function (result) { console.log("error RegisterPopup =\> "+result); } }); } //if(result == "success"){ // alert(result); //} }, error: function (result) { console.log("error Signup =\>"+result); } }); function GTM\_info\_createaccountpop() { dataLayer.push({ event: "info\_createaccount", account\_status: acc\_status\_pop, // \*\*\*Required / eg. empty, not match, ID duplicate, Contact Duplicate, success }); } //GTM Motor renewal function gtmLoadModalError4(){ $.ajax({ type: "POST", url: "/RenewCheckInsurance/get\_gtm\_product\_category", data: { //type:type, req: SendObject }, //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, success: function (data) { dataLayer.push({ event: "renew\_plan", event\_category: "renew\_plan", event\_action: "display", event\_label: "pop-up\_exit", product\_category: data }); } }); } //เมื่อ user click ปุ่ม ยกเลิก function gtmCancelModalError4() { $.ajax({ type: "POST", url: "/RenewCheckInsurance/get\_gtm\_product\_category", data: { //type:type, req: SendObject }, //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, success: function (data) { dataLayer.push({ event: "renew\_plan", event\_category: "renew\_plan", event\_action: "click", event\_label: "ยกเลิก", product\_category: data }); } }); } //เมื่อ user click ปุ่ม ออก function gtmCancelModalError4() { $.ajax({ type: "POST", url: "/RenewCheckInsurance/get\_gtm\_product\_category", data: { //type:type, req: SendObject }, //beforeSend: function(xhr) { //	xhr.setRequestHeader('X-CSRF-Token', csrfToken) //}, success: function (data) { dataLayer.push({ event: "renew\_plan", event\_category: "renew\_plan", event\_action: "click", event\_label: "ออก", product\_category: data }); } }); } }

เลขที่ใบอนุญาตประกันวินาศภัย

//\<![CDATA[
window.\_\_mirage2 = {petok:"CbTB0BYrSCco7jQApPWZyMqRBlV8Zfep3XSAVfpkQAQ-1800-0.0.1.1"};
//]]\><img alt="เลขที่ใบอนุญาตประกันวินาศภัย" class="img-fluid" oncontextmenu="return false;" width="752" height="532" data-cfsrc="/heygoody/media/source/license/image-footer-heygoody-broker-license.jpg" style="display:none;visibility:hidden;">\<img src="/heygoody/media/source/license/image-footer-heygoody-broker-license.jpg" alt="เลขที่ใบอนุญาตประกันวินาศภัย" class="img-fluid" oncontextmenu="return false;" width="752" height="532"/\>

 function modalLicense() { $("#BrokerLicense").modal("show"); }

 $(document).ready(function () { //let sessionGTM\_user\_data = ''; //if(sessionGTM\_user\_data != ""){ //	$("#GTM\_user\_data").val(sessionGTM\_user\_data); //} var insuranceName = ""; if ($('#GTM\_car\_last\_insurance').val() != "") { $.ajax({ type: "POST", url: "/CheckInsurance/GetInsuranceInfo", async: false, data: { type: "name", code: $('#GTM\_car\_last\_insurance').val() }, beforeSend: function (xhr) { xhr.setRequestHeader('X-CSRF-Token', csrfToken) }, success: function (data) { insuranceName = data; } }); } //setTimeout(() =\> { // var GTM\_user\_data = $("#GTM\_user\_data").val(); // PushGTMUserData(JSON.parse(GTM\_user\_data), insuranceName) //}, 850) ready\_customValidate(); let forname = getFormName(); if (forname == "LOGIN") { $(".no-login").addClass("d-none"); } }); function PushGTMUserData(AllPageLoad, insuranceName) { var res = []; res = AllPageLoad; if (res.user\_type == "guest") { res.user\_id = adbrix.getDeviceId(); } res.car\_brand = $('#GTM\_car\_brand').val(); // eg. toyota, honda res.car\_model = $('#GTM\_car\_model').val(); //eg. civic, city, yaris res.car\_year = $('#GTM\_car\_year').val(); // eg. 2009, 2021 res.car\_detail = $("#GTM\_car\_detail").val(); // eg. sedan 4dr RWD (sport) res.car\_using\_purpose = $('#GTM\_car\_using\_purpose').val(); // eg. personal, commercial res.car\_decoration = $('#GTM\_car\_decoration').val(); // eg. none, แต่งจากศูนย์, แต่งนอกศูนย์ res.car\_last\_insurance = insuranceName; // eg. สินมั่นคงประกันภัย res.car\_insurance = $('#GTM\_car\_insurance').val(); // eg. ประกันหมดอายุ, ไม่มีประกันรถยนต์ res.car\_coverage\_date = $("#GTM\_car\_coverage\_date").val();// eg. ปีนี้, ปีหน้า res.car\_registered\_province = $("#GTM\_car\_registered\_province").val(); // eg. กทม, ปทุมธานี, นนทบุรี dataLayer.push({ user\_data: res }); } function redirect(link) { window.location.href = window.location.origin + "/" + link.toLowerCase(); } function goBack() { if (getFormName() == "SUMMARY") { window.location.href = window.location.origin + "/ordersinfo"; } if (getFormName() == "COMPARE") { window.location.href = window.location.origin + "/checkinsurance/plan"; } else { window.history.back(); } dataLayer.push({ event: 'click\_back', }); } function getFormName() { var str = window.location.pathname; var array = str.split("/"); var form = array[array.length - 1]; return form.toUpperCase(); } function callModal(e) { $("body").addClass("fn-modal-open"); $("#" + e).css("display", "block"); $("body").append("\<div class='modal-backdrop fade show'\>\</div\>"); var counter = setInterval(() =\> { clearInterval(counter); $("#" + e).addClass("show"); }, 150); } function closeModal(e) { $("#" + e).removeClass("show"); var counter = setInterval(() =\> { clearInterval(counter); $("#" + e).css("display", "none"); $(".modal-backdrop").remove(); }, 150); $("body").removeClass("fn-modal-open"); }